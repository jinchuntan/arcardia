<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
    <title>ARCardia • Scan</title>
    <style>
      :root{
        --edge: clamp(12px, 2.2vw, 18px);
        --panelW: 380px;
      }

      *{ box-sizing:border-box; }
      html, body { height: 100%; }
      body { margin:0; background:#05060a; overflow:hidden; }
      canvas, video { display:block; }

      /* Camera video full-screen */
      video{
        position: fixed;
        inset: 0;
        width: 100%;
        height: 100%;
        object-fit: cover;
        z-index: 0;
      }
      canvas{
        position: fixed;
        inset: 0;
        z-index: 1;
      }

      /* UI overlay */
      #ar-ui{
        position: fixed;
        inset: 0;
        z-index: 10;
        pointer-events: none;
        font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
        color: #fff;
      }

      #panel{
        position: absolute;
        top: calc(var(--edge) + env(safe-area-inset-top));
        right: calc(var(--edge) + env(safe-area-inset-right));

        width: min(var(--panelW), calc(100% - (2 * var(--edge)) - env(safe-area-inset-left) - env(safe-area-inset-right)));
        max-height: calc(100dvh - (2 * var(--edge)) - env(safe-area-inset-top) - env(safe-area-inset-bottom));

        overflow:auto;
        -webkit-overflow-scrolling: touch;

        background: rgba(0,0,0,0.60);
        border: 1px solid rgba(255,255,255,0.15);
        border-radius: 14px;
        padding: 14px;
        pointer-events: auto;
        backdrop-filter: blur(8px);
      }

      #cardTitle{ font-weight: 950; font-size: clamp(14px, 2vw, 16px); }
      #cardCategory{ opacity: 0.85; font-size: 13px; margin-top: 2px; }

      #cardFacts{
        margin-top: 12px;
        line-height: 1.45;
        font-size: clamp(13px, 1.8vw, 14px);
        opacity: 0.95;
        min-height: 44px;
        white-space: pre-wrap;
      }

      #panelActions{
        display:flex;
        gap: 8px;
        margin-top: 12px;
        flex-wrap: wrap;
      }

      /* Buttons + Exit link share the same look */
      #panelActions button,
      #panelActions a.btnLink{
        flex: 1 1 110px;
        padding: 10px;
        border-radius: 10px;
        border: 1px solid rgba(255,255,255,0.25);
        background: rgba(255,255,255,0.08);
        color:#fff;
        cursor:pointer;
        touch-action: manipulation;
        text-decoration:none;
        display:inline-flex;
        align-items:center;
        justify-content:center;
        font-weight: 900;
      }

      #panelActions button:disabled{
        opacity: 0.4;
        cursor:not-allowed;
      }

      /* Exit styling */
      #btnExit{
        border-color: rgba(255,255,255,0.30);
        background: linear-gradient(135deg, rgba(255,120,0,0.20), rgba(255,0,120,0.16));
      }
      #btnExit:hover{
        border-color: rgba(255,255,255,0.42);
      }

      #panelFooter{ margin-top: 10px; font-size: 12px; opacity: 0.75; }

      /* Phones / tablet portrait: bottom sheet */
      @media (max-width: 860px){
        #panel{
          left: calc(var(--edge) + env(safe-area-inset-left));
          right: calc(var(--edge) + env(safe-area-inset-right));
          top: auto;
          bottom: calc(var(--edge) + env(safe-area-inset-bottom));
          width: auto;
          max-height: min(46dvh, 520px);
        }
      }

      @media (max-width: 420px){
        #panel{ padding: 12px; }
        #panelActions button,
        #panelActions a.btnLink{ flex: 1 1 30%; }
      }
    </style>
  </head>

  <body>
    <div id="ar-ui">
      <div id="panel">
        <div id="panelHeader">
          <div id="cardTitle">Point at your card…</div>
          <div id="cardCategory"></div>
        </div>

        <div id="cardFacts">Waiting for target…</div>

        <div id="panelActions">
          <button id="btnPrev" type="button" disabled>Prev</button>
          <button id="btnNext" type="button" disabled>Next</button>
          <button id="btnCollect" type="button" disabled>Collect</button>

          <!-- Exit is a link: simplest + most reliable -->
          <a id="btnExit" class="btnLink" href="/exit.html">Exit</a>
        </div>

        <div id="panelFooter">
          <span id="cardStatus">Waiting for target…</span>
        </div>
      </div>
    </div>

    <!-- Your AR code -->
    <script type="module" src="/src/scan.ts"></script>
  </body>
</html>
